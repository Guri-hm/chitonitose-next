---
title: "ルビと用語のテスト"
overview: "rubyタグと[[term]]の組み合わせテスト"
---

## パターン1: 現在の形式（rubyタグ内に[[...]]）

:::top
用途別には、煮炊き用の<ruby>[[甕]]<rt>かめ</rt></ruby>、貯蔵用の<ruby>[[壺]]<rt>つぼ</rt></ruby>、食物を盛る鉢や<ruby>[[高杯]]<rt>たかつき</rt></ruby>がありました。
:::

期待する出力: `<ruby><span class="all">甕</span><rt>かめ</rt></ruby>`

---

## パターン2: パイプ記法（[[term|reading]]）← 推奨！

:::top
用途別には、煮炊き用の[[甕|かめ]]、貯蔵用の[[壺|つぼ]]、食物を盛る鉢や[[高杯|たかつき]]がありました。
:::

期待する出力: `<ruby><span class="all">甕</span><rt>かめ</rt></ruby>`（remarkTermsで変換済み）

### 複数のルビ付き用語

:::top
[[打製]]石器を用いた[[旧石器]]時代と、[[磨製]]石器が出現した[[新石器]]時代
:::

### ルビなし用語との混在

:::top
[[打製|だせい]]石器を用いた[[旧石器]]時代と、[[磨製|ませい]]石器が出現した[[新石器]]時代
:::

### マーカーとの組み合わせ

:::top
==[[間氷期|かんぴょうき]]と[[氷期|ひょうき]]==
:::

### 赤文字との組み合わせ

:::top
**[[竪杵|たてぎね]]**
:::

---

## パターン3: rubyタグの外に[[...]]

:::top
用途別には、煮炊き用の[[<ruby>甕<rt>かめ</rt></ruby>]]、貯蔵用の[[<ruby>壺<rt>つぼ</rt></ruby>]]、食物を盛る鉢や[[<ruby>高杯<rt>たかつき</rt></ruby>]]がありました。
:::

期待する出力: `<span class="all"><ruby>甕<rt>かめ</rt></ruby></span>`

---

## パターン4: 分離記法（rubyと[[...]]を別々に）

:::top
用途別には、煮炊き用の<ruby>甕<rt>かめ</rt></ruby>、貯蔵用の<ruby>壺<rt>つぼ</rt></ruby>、食物を盛る鉢や<ruby>高杯<rt>たかつき</rt></ruby>がありました。
:::

期待する出力: `<ruby>甕<rt>かめ</rt></ruby>`（用語変換なし）

---

## パターン5: マーカーとの組み合わせ（参考）

:::top
==<ruby>間氷期<rt>かんぴょうき</rt></ruby>と<ruby>氷期<rt>ひょうき</rt></ruby>==
:::

期待する出力: `<span class="marker"><ruby>間氷期<rt>かんぴょうき</rt></ruby>と<ruby>氷期<rt>ひょうき</rt></ruby></span>`

---

## パターン6: 赤文字とrubyの組み合わせ（参考）

:::top
**<ruby>竪杵<rt>たてぎね</rt></ruby>**
:::

期待する出力: `<font color="#FF0000"><ruby>竪杵<rt>たてぎね</rt></ruby></font>`

---

## 検証項目

1. remarkTermsは`<ruby>[[term]]<rt>reading</rt></ruby>`を正しく処理できるか？
2. `[[term|reading]]`形式の方が安定するか？（プラグイン修正が必要）
3. `[[<ruby>term<rt>reading</rt></ruby>]]`は処理可能か？
4. マーカー・赤文字とrubyの組み合わせは問題ないか？

---

## 推奨アプローチの検討

### アプローチA: パイプ記法を導入

remarkTermsを拡張して`[[term|reading]]`を`<ruby><span class="all">term</span><rt>reading</rt></ruby>`に変換

**メリット:**
- MDX構文のみで完結（HTMLタグ不要）
- AST処理が単純（テキストノードのみ）
- 保守性が高い

**デメリット:**
- プラグイン修正が必要
- 既存の[[term]]との互換性を保つ必要がある

### アプローチB: 現状維持（rubyタグ使用）

`<ruby>[[term]]<rt>reading</rt></ruby>`形式を維持し、remarkTermsの多ノード処理で対応

**メリット:**
- プラグイン修正が不要（既に実装済み）
- HTMLの標準的な書き方

**デメリット:**
- AST処理が複雑
- 失敗しやすい可能性

### アプローチC: 用語とルビを分離

ルビが必要な場合は[[...]]を使わず、`<ruby>`のみ使用

**メリット:**
- シンプル
- 確実に動作

**デメリット:**
- 用語クリック機能が使えない
- 一貫性がない
